generator client {
  provider = "prisma-client-js"
}

//NÃO TIREM OS COMETÁRIOS ELES DOCUMENTAM AS ALTERAÇÕES E FUNCIONALIDADES IMPORTANTES 

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Participante {
  id           String @id @default(auto()) @map("_id") @db.ObjectId
  even3Id      Int    @unique
  nome         String
  email        String @unique
  senha        String? 
  
  // CORREÇÃO AQUI: 
  presencas    Presenca[]
  feedbacks    Feedback[]
  
  @@map("participantes")
}

model Palestra {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  even3Id     Int      @unique
  titulo      String
  descricao   String?
  tipo        String
  local       String?
  
  horarios    HorarioEmbed[]
  palestrantes PalestranteEmbed[]
  
  // CORREÇÃO AQUI: Sem '?'
  presencas    Presenca[]
  feedbacks    Feedback[]
  
  @@map("palestras")
}

type HorarioEmbed {
  id_time    Int?
  date_start String? 
  date_end   String?
}

type PalestranteEmbed {
  even3Id   Int
  nome      String
  bio       String?
}

model Presenca {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  
  participanteId  String   @db.ObjectId
  participante    Participante @relation(fields: [participanteId], references: [id])
  
  palestraId      String   @db.ObjectId
  palestra        Palestra @relation(fields: [palestraId], references: [id])
  
  dataHora        DateTime @default(now())
  sincronizado    Boolean  @default(false)
  
  @@map("presencas")
  @@unique([participanteId, palestraId])
}

model Feedback {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  comentario      String
  nota            Int
  
  participanteId  String   @db.ObjectId
  participante    Participante @relation(fields: [participanteId], references: [id])
  
  palestraId      String   @db.ObjectId
  palestra        Palestra @relation(fields: [palestraId], references: [id])

  @@map("feedbacks")
}